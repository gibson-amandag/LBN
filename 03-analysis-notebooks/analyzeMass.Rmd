---
title: "mass"
output:
  pdf_document: default
  html_notebook: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
# options(digits=3)
```

```{r}
source("./01-scripts/01-set-up.R")
source(file.path(scriptsFolder, "02-get-datasets.R"))
```

```{r}
Dam_demo_2ndLitters <- Demo_dam %>%
  filter(
    litterNum == 2,
    ParaType == 4,
    is.na(Pups_through_wean) | Pups_through_wean == TRUE,
    !is.na(Dam_Mass_P21)
  )

Dam_demo_2ndLitters
Dam_demo_2ndLitters %>%
  t_test(
  Avg_litter_mass_startPara ~ earlyLifeTrt
)
```

```{r}
Mass_2ndLitters <- Mass_off %>%
  filter(
    litterNum == 2,
    ParaType == 4
  )

Mass_2ndLitters_long <- pivot_longer(
  Mass_2ndLitters,
  cols = starts_with("Mass_P"),
  names_to = "day",
  names_prefix = "Mass_P",
  values_to = "mass",
  values_drop_na = TRUE,
  names_transform = list("day" = as.integer)
) %>%
  relocate(
    day,
    mass,
    .after = earlyLifeTrt
  )
```

## Repeated measured ANOVA, without sex
```{r}
Mass_2ndLitters_long %>%
  filter(
    day != 4 # don't include day 4, start of paradigm
  ) %>%
  anova_test(
    dv = mass,
    wid = mouseID,
    within = day,
    between = earlyLifeTrt,
    type = 3
  )

Mass_2ndLitters_long %>%
  filter(
    day != 4 # don't include day 4, start of paradigm
  ) %>%
  group_by(
    day
  ) %>%
  anova_test(
    dv = mass,
    wid = mouseID,
    between = earlyLifeTrt,
    type = 3
  )%>%
  adjust_pvalue(method = "bonferroni")
```
```{r}
Mass_2ndLitters_long %>%
  filter(
    day != 4 # don't include day 4, start of paradigm
  ) %>%
  anova_test(
    dv = mass,
    wid = mouseID,
    within = day,
    between = c(earlyLifeTrt, sex),
    type = 3
  )

Mass_2ndLitters_long %>%
  filter(
    day != 4 # don't include day 4, start of paradigm
  ) %>%
  group_by(
    day
  ) %>%
  anova_test(
    dv = mass,
    wid = mouseID,
    between = c(earlyLifeTrt, sex),
    type = 3
  )%>%
  adjust_pvalue(method = "bonferroni")
testMulti <- Mass_2ndLitters_long %>%
  filter(
    day != 4 # don't include day 4, start of paradigm
  ) %>%
  group_by(
    sex
  ) %>%
  anova_test(
    dv = mass,
    wid = mouseID,
    within = day,
    between = earlyLifeTrt,
    type = 3
  # )%>%
  # adjust_pvalue(method = "bonferroni"
                )

testMulti$anova
```

Group by dam and sex - no sig diffs with early-life treatment

```{r}
Mass_2ndLitters %>%
  filter(
    damID != "D020-02"
  ) %>%
  getAvgByDam(bySex = TRUE) %>% makeOffMassLong() %>%
  relocate(sex, day, mass, .after = damID) %>%
  filter(
    day != 4
  ) %>%
  anova_test(
    dv = mass,
    wid = damID,
    within = c(day, sex), # now there are multiple sexes for each dam
    between = earlyLifeTrt
  ) %>%
  formatAnova()

Mass_2ndLitters %>%
  filter(
    damID != "D020-02"
  ) %>%
  getAvgByDam(bySex = TRUE) %>% makeOffMassLong() %>%
  filter(
    day != 4
  ) %>%
  group_by(day) %>%
  anova_test(
    dv = mass,
    wid = damID,
    within = c(sex),
    between = earlyLifeTrt
  ) %>%
  formatAnova()
```

Group by dam - interaction between day and early-life treatment, but no sig differences on any given day

```{r}
Mass_2ndLitters %>%
  filter(
    damID != "D020-02"
  ) %>%
  getAvgByDam() %>%
  makeOffMassLong() %>%
  anova_test(
    dv = mass,
    wid = damID, 
    within = day,
    between = earlyLifeTrt
  ) %>%
  formatAnova()

Mass_2ndLitters %>%
  filter(
    damID != "D020-02"
  ) %>%
  getAvgByDam() %>%
  makeOffMassLong() %>%
  group_by(
    day
  ) %>%
  anova_test(
    dv = mass,
    wid = damID,
    between = earlyLifeTrt
  ) %>%
  formatAnova()
```



## Repeated measured ANOVA, with sex
```{r}

```

