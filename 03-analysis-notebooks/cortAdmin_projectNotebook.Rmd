---
title: "Nutella - Cort Admin"
output: html_notebook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
# options(digits=3)
```

```{r include=FALSE}
# If can't find it, be sure that the directory is the project directory
# Arrow between notebook and settings gear -> Knit directory
source("./01-scripts/01-set-up.R") ## IDK why, but doesn't seem to work the first time in new environment
source("./01-scripts/01-set-up.R")
source(file.path(scriptsFolder, "cortAdmin-get-datasets.R"))
```

```{r}
BD_offspringInfo %>%
  filter(
    cohort == "AG_BW"
  ) %>%
  createRemainingPPT(
    addToName = "BD" 
    , includeYesterday = TRUE
    , useVar = Sampling_date
    )
```
```{r}
BD_offspringInfo %>%
  filter(
    cohort == "AG_BW"
  ) %>%
  createOvulationPPT(
    addToName = "BD"
    , useVar = Sampling_date
    )
```


```{r}

saveDFsToExcel(
  "nutellaCortAdmin"
  , prefix = ""
  , "cortAdmin" = BD_sampling %>%
    select(
      mouseID,
      dosage,
      oocytes1,
      oocytes2,
      notes,
      trust,
      starts_with("LH"),
      maxLH
    ) %>%
    arrange(
      -trust,
      dosage
    )
)

```
```{r}
LHPlot_adultTrt(
  BD_LH %>% makeFactors(dosage) %>% filter(trust == TRUE, !is.na(LH)),
  trtVar = dosage,
  trtName = "doseage (mg/kg)",
  trtLineGuide = c("0" = "dotted", "2" = "solid"),
  trtFill = scale_fill_manual(
    "dosage (mg/kg)",
    values = c("0" = "white", "2" = "black")
  ),
  trtColor = scale_color_manual(
    "dosage (mg/kg)",
    values = c("0" = "black", "2" = "black")
  )
) + facet_wrap(
  ~ dosage,
  ncol = 2
)
```

