---
title: "Dam behavior"
output: html_notebook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
# options(digits=3)
```

```{r}
source("./01-scripts/01-set-up.R")
source(file.path(scriptsFolder, "02-get-datasets.R"))
```

```{r}
dam_behavior_litter2 <- dam_behavior %>%
  filter(
    litterNum == 2
  )
```

# Number of Exits - Lights Off
```{r}
dam_behavior_litter2 %>%
  filter(
    time == 14
  ) %>%
  scatterPlotLBN(
    yVar = Num_exits,
    yLab = "number of exits"
  )
```

## Correlation with % on nest
```{r}
dam_behavior_litter2 %>%
  filter(
    time == 14
  ) %>%
  scatterPlotTwoVars_byLBN(
    yVar = Num_exits,
    yLab = "number of exits",
    xVar = Perc_on_nest,
    xLab = "% on nest"
  )
```

# Number of exits lights on
```{r}
numExits_ZT0 <- dam_behavior_litter2 %>%
  filter(
    time == 0
  ) %>%
  scatterPlotLBN(
    yVar = Num_exits,
    yLab = "number of exits"
  )
numExits_ZT0
```

## Correlation with % on nest
```{r}
numExitsAndPercOn <- dam_behavior_litter2 %>%
  filter(
    time == 0
  ) %>%
  scatterPlotTwoVars_byLBN(
    yVar = Num_exits,
    yLab = "number of exits",
    xVar = Perc_on_nest,
    xLab = "% on nest"
  )
numExitsAndPercOn
```

# Number of Exits - 5 hr after lights off
```{r}
dam_behavior_litter2 %>%
  filter(
    time == 19
  ) %>%
  scatterPlotLBN(
    yVar = Num_exits,
    yLab = "number of exits"
  )
```
## t-test
```{r}
dam_behavior_litter2 %>%
  filter(
    time == 19
  ) %>%
  t_test(
    Num_exits ~ earlyLifeTrt
  )
```


## Correlation with % on nest
```{r}
dam_behavior_litter2 %>%
  filter(
    time == 19
  ) %>%
  scatterPlotTwoVars_byLBN(
    yVar = Num_exits,
    yLab = "number of exits",
    xVar = Perc_on_nest,
    xLab = "% on nest"
  )
```

```{r}
behaviorOverTime <- dam_behavior %>%
  behavior_overTime(
    yVar = Num_exits,
    yLab = "# of exits"
  )
behaviorOverTime +
  facet_wrap(
    ~earlyLifeTrt
  )+
  theme(
    legend.position = "none"
  )
```

```{r}
dam_behavior_litter2 %>%
  anova_test(
    dv = Num_exits,
    wid = damID,
    between = earlyLifeTrt,
    within = time,
    type = 3
  )
```


# Cohort 2
```{r}
dam_behavior_cohort2 <- dam_behavior %>%
  filter(
    cohort == 2
  )
dam_behavior_cohort2
```

