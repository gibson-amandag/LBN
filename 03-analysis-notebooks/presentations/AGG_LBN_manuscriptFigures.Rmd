---
title: "R Notebook"
output: html_notebook
# fig-width: 11.5
# fig-height: 5
df-print: kable
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
# knitr::opts_chunk$set(fig.width=11.5, fig.height=5) 
# options(digits=3)
```

```{r include=FALSE}
source("./01-scripts/01-set-up.R")
source(file.path(scriptsFolder, "02-get-datasets.R"))
source("./01-scripts/04-filter-datasets.R")
source("./01-scripts/05-make-LBN-plots-manuscript.R")
source("./01-scripts/06-make-LBN-ANOVAs_noLitter.R")
```

```{r}
doc.type <- knitr::opts_knit$get('rmarkdown.pandoc.to')
```

# Column Sizes
```{r}
# JNeuro values (in cm)
twoCols <- 17.4
oneAndHalfCols <- 11.5
oneCol <- 8.5
```

# Figure 1 - Dams figDams

```{r}
# trying to fix font errors
# this seems to work for not putting the axis label on top of the tick labels
# but the axes don't actually align with align_plots
# update - Maybe works???? IDK WHAT I DID!
set_null_device("png") 

# # this works for aligning the axes with align_plots
# # but then faceted plot yaxis label overlaps
# set_null_device("pdf")
# 
# # this works for aligning the axes with align_plots
# # but then faceted plot yaxis label overlaps
# set_null_device("cairo_pdf")
```


```{r}
figDamsPlots <- cowplot::align_plots(figDamsB, figDamsC, align = "v", axis = "l")

figDams <- plot_grid(
  NULL
  , figDamsPlots[[1]]
  , NULL
  , plot_grid(
    figDamsPlots[[2]]
    , figDamsD
    , ncol = 2
    , labels = c("C", "D")
    , label_fontfamily = "Arial"
    , label_size = textSize
  )
  , nrow = 4
  , labels = c("A", NULL, "B", NULL)
  , label_fontfamily = "Arial"
  , label_size = textSize
  , rel_heights = c(0.5, 1, .1, 1)
)
figDams
```


```{r}
flexSave(
  "figDams"
  , plot = figDams
  , width = twoCols
  , height = 28/3*2
  , units = "cm"
)
```

# Figure 2 - Offspring maturation figOff

## individual maturation
```{r}
figOffLeftPlots <- cowplot::align_plots(
  figOffA
  , figOffB
  , figOffC
  , align = "v", axis = "l"
)

figOffMidPlots <- cowplot::align_plots(
  figOffD
  , figOffE
  , align = "v", axis = "l"
)

figOffRightPlots <- cowplot::align_plots(
  figOffF
  , figOffG
  , align = "v", axis = "l"
)

figOffRow2 <- plot_grid(
  figOffLeftPlots[[2]]
  , figOffMidPlots[[1]]
  , figOffRightPlots[[1]]
  , ncol = 3
  , labels = c("Bi", "Ci", "Di")
  , label_fontfamily = "Arial"
  , label_size = textSize
)

figOffRow3 <- plot_grid(
  figOffLeftPlots[[3]]
  , figOffMidPlots[[2]]
  , figOffRightPlots[[2]]
  , ncol = 3
  , labels = c("Bii", "Cii", "Dii")
  , label_fontfamily = "Arial"
  , label_size = textSize
)

figOff <- plot_grid(
  figOffLeftPlots[[1]]
  , figOffRow2
  , figOffRow3
  , nrow = 3
  , labels = c("A", NULL, NULL)
  , label_fontfamily = "Arial"
  , label_size = textSize
  , rel_heights = c(1.5, 1, 1)
)
figOff
```

## grouped maturation
```{r}
figOffLeftPlots <- cowplot::align_plots(
  figOffA
  , figOffAge
  , figOffMass
  , align = "v", axis = "l"
)

figOffRightPlots <- cowplot::align_plots(
  figOffH
  , figOffI
  , align = "vh", axis = "ltrb"
)

figOffLab1 <- plot_grid(
  NULL
  , NULL
  , NULL
  , NULL
  , ncol = 4
  , labels = c("       B", "    C", " D", "H")
  , label_fontfamily = "Arial"
  , label_size = textSize
)

figOffLab2 <- plot_grid(
  NULL
  , NULL
  , NULL
  , NULL
  , ncol = 4
  , labels = c("       E", "    F", " G", "I")
  , label_fontfamily = "Arial"
  , label_size = textSize
)

figOffMat <- plot_grid(
  figOffLab1
  , plot_grid(
      figOffLeftPlots[[2]]
      , figOffRightPlots[[1]]
      , ncol = 2
      , rel_widths = c(3, 1)
  )
  , figOffLab2
  , plot_grid(
      figOffLeftPlots[[3]]
      , figOffRightPlots[[2]]
      , ncol = 2
      , rel_widths = c(3, 1)
  )
  , nrow = 4
  , rel_heights = c(0.01, 1, 0.01, 1)
)

figOff <- plot_grid(
  figOffLeftPlots[[1]]
  , figOffMat
  , nrow = 2
  , labels = c("A", NULL)
  , label_fontfamily = "Arial"
  , label_size = textSize
  , rel_heights = c(1.5, 2)
)
figOff
```

```{r}
flexSave(
  "figOff"
  , plot = figOff
  , width = twoCols
  , height = 28/3*1.75
  , units = "cm"
)
```

# Figure 3 - Cycles

```{r}
figCyclesLeftPlots <- cowplot::align_plots(
  figCyclesA
  , figCyclesB
  , align = "v", axis = "l"
)

figCycles2ndRow <- plot_grid(
  figCyclesLeftPlots[[2]]
  , figCyclesC
  , figCyclesD
  , ncol = 3
  , labels = c("B", "C", "D")
  , label_fontfamily = "Arial"
  , label_size = textSize
  , align = "h"
  , axis = "bt"
  , rel_widths = c(1, 1, 2)
)

figCycles <- plot_grid(
  figCyclesLeftPlots[[1]]
  , figCycles2ndRow
  , nrow = 2
  , rel_heights = c(2.2, 3)
  , labels = c("A", NULL)
  , label_fontfamily = "Arial"
  , label_size = textSize
)
figCycles
```

```{r}
flexSave(
  "figCycles"
  , plot = figCycles
  , width = twoCols
  , height = 28/3
  , units = "cm"
)
```

# Figure 4 - Corticosterone

```{r}
figCort_leftCol <- cowplot::align_plots(
  figCortA
  , figCortB
  , figCortC
  , align = "v", axis = "lr"
)

figCort <- plot_grid(
  figCortA
  , figCortB
  , figCortC
  , nrow = 3
  , align = "vh", axis = "ltrb"
)

figCort

```




```{r}
figCort_opt1 <- plot_grid(
  get_legend(figCort_opt1A)
  , figCort_opt1A + rremove("legend")
  , figCort_opt1B + rremove("legend")
  , figCort_opt1C + rremove("legend")
  , nrow = 4
  , labels = c("", "A", "B", "C")
  , label_fontfamily = "Arial"
  , label_size = textSize
  , align = "v"
  , axis = "lr"
  , rel_heights = c(0.2, 1, 1, 1)
)

figCort_opt1
```

```{r}
flexSave(
  "figCort_opt1"
  , plot = figCort_opt1
  , width = oneCol
  , height = 28/3*2
  , units = "cm"
)
```

```{r}
figCort_opt2 <- plot_grid(
  figCort_opt2A
  , figCort_opt2B
  , figCort_opt2C
  , nrow = 3
  , labels = c("A", "B", "C")
  , label_fontfamily = "Arial"
  , label_size = textSize
  , align = "v"
  , axis = "lr"
)
figCort_opt2
```

```{r}
flexSave(
  "figCort_opt2"
  , plot = figCort_opt2
  , width = twoCols
  , height = 28/2
  , units = "cm"
)
```

```{r}
figCort_opt3_graphs <- plot_grid(
  figCort_opt3A + rremove("legend")
  , figCort_opt3B + rremove("legend")
  , figCort_opt3C + rremove("legend")
  , ncol = 3
  , labels = c("A", "B", "C")
  , label_fontfamily = "Arial"
  , label_size = textSize
  , align = "h"
  , axis = "tb"
)

figCort_opt3 <- plot_grid(
  figCort_opt3_graphs
  , get_legend(figCort_opt3A)
  , nrow = 2
  , rel_heights = c(1, .03)
)

figCort_opt3
```

```{r}
flexSave(
  "figCort_opt3"
  , plot = figCort_opt3
  , width = twoCols
  , height = 28/3
  , units = "cm"
)
```

# Figure 5 - Masses

```{r}
figMass <- plot_grid(
  figMassA
  , figMassB
  , figMassC
  , figMassD
  , figMassE
  , figMassF
  , figMassG
  , figMassH
  , figMassI
  , figMassJ
  , figMassK
  , figMassL
  , ncol = 3
  , align = "hv"
  , axis = "tblr"
  , labels = c(
    "A"
    , "B"
    , "C"
    , "D"
    , "E"
    , "F"
    , "G"
    , "H"
    , "I"
    , "J"
    , "K"
    , "L"
  )
)

figMass
```

```{r}
figMassFacet <- plot_grid(
  get_legend(figMassFacetA)
  , figMassFacetA + rremove("legend")
  , figMassFacetB
  , figMassFacetC
  , figMassFacetD
  , nrow = 5
  , align = "hv"
  , axis = "tblr"
  , labels = c(
    ""
    , "A"
    , "B"
    , "C"
    , "D"
  )
  , rel_heights = c(0.1, 1, 1, 1, 1)
)

figMassFacet
```

```{r}
flexSave(
  "figMassFacet"
  , plot = figMassFacet
  , width = twoCols
  , height = 28/3*2
  , units = "cm"
)
```
```{r}
flexSave(
  "figMass"
  , plot = figMass
  , width = twoCols
  , height = 28/3*2
  , units = "cm"
)
```


# Figure 6 - LH


# Figure 7 - GABA PSCs

```{r}
figGABA_aligned <- cowplot::align_plots(
  figGABAa
  , figGABAb
  , figGABAc
  , figGABAd
  , figGABAe
  , figGABAf
  , align = "vh"
  , axis = "lrtb"
)

figGABA1stRow <- plot_grid(
  figGABA_aligned[[1]]
  , figGABA_aligned[[2]]
  , figGABA_aligned[[3]]
  , ncol = 3
  , labels = c("A", "B", "C")
  , label_fontfamily = "Arial"
  , label_size = textSize
)

figGABA2ndRow <- plot_grid(
  figGABA_aligned[[4]]
  , figGABA_aligned[[5]]
  , figGABA_aligned[[6]]
  , ncol = 3
  , labels = c("D", "E", "F")
  , label_fontfamily = "Arial"
  , label_size = textSize
)

figGABA <- plot_grid(
  figGABA1stRow
  , figGABA2ndRow
  , NULL
  , nrow = 3
  , labels = c("", "", "G")
  , label_fontfamily = "Arial"
  , label_size = textSize
  , rel_heights = c(2, 2, 1)
)

figGABA
```
```{r eval=FALSE, include=FALSE}

figGABA1stCol <- cowplot::align_plots(
  figGABAa
  , figGABAd
  , align = "v", axis = "l"
)

figGABA2ndCol <- cowplot::align_plots(
  figGABAb
  , figGABAe
  , align = "v", axis = "l"
)

figGABA3rdCol <- cowplot::align_plots(
  figGABAc
  , figGABAf
  , align = "v", axis = "l"
)

# eventually 3rd col

figGABA1stRow <- plot_grid(
  figGABA1stCol[[1]]
  , figGABA2ndCol[[1]]
  , figGABA3rdCol[[1]]
  , ncol = 3
  , labels = c("A", "B", "C")
  , label_fontfamily = "Arial"
  , label_size = textSize
  , align = "h"
  , axis = "bt"
)

figGABA2ndRow <- plot_grid(
  figGABA1stCol[[2]]
  , figGABA2ndCol[[2]]
  , figGABA3rdCol[[2]]
  , ncol = 3
  , labels = c("D", "E", "F")
  , label_fontfamily = "Arial"
  , label_size = textSize
  , align = "h"
  , axis = "bt"
  , rel_widths = c(1, 1, 1)
)

figGABA <- plot_grid(
  figGABA1stRow
  , figGABA2ndRow
  , NULL
  , nrow = 3
  , labels = c("", "", "G")
  , label_fontfamily = "Arial"
  , label_size = textSize
  , rel_heights = c(2, 2, 1)
)

figGABA
```

```{r eval=FALSE, include=FALSE}
figGABA1stCol <- cowplot::align_plots(
  figGABAa
  , figGABAc
  , figGABAe
  , align = "v", axis = "l"
)

figGABA2ndCol <- cowplot::align_plots(
  figGABAb
  , figGABAd
  , figGABAf
  , align = "v", axis = "l"
)

figGABA1stRow <- plot_grid(
  figGABA1stCol[[1]]
  , figGABA2ndCol[[1]]
  , ncol = 2
  , labels = c("A", "B")
  , label_fontfamily = "Arial"
  , label_size = textSize
  , align = "h"
  , axis = "bt"
)

figGABA2ndRow <- plot_grid(
  figGABA1stCol[[2]]
  , figGABA2ndCol[[2]]
  , ncol = 2
  , labels = c("C", "D")
  , label_fontfamily = "Arial"
  , label_size = textSize
  , align = "h"
  , axis = "bt"
)

figGABA3rdRow <- plot_grid(
  figGABA1stCol[[3]]
  , figGABA2ndCol[[3]]
  , ncol = 2
  , labels = c("E", "F")
  , label_fontfamily = "Arial"
  , label_size = textSize
  , align = "h"
  , axis = "bt"
)

figGABAdata <- plot_grid(
  figGABA1stRow
  , figGABA2ndRow
  , figGABA3rdRow
  , nrow = 3
)

figGABA <- plot_grid(
  figGABAdata
  , NULL
  , ncol = 2
  , rel_widths = c(3, 1)
  , labels = c("", "G")
  , label_fontfamily = "Arial"
  , label_size = textSize
)

figGABA
```

```{r eval=FALSE, include=FALSE}
figGABA1stCol <- cowplot::align_plots(
  figGABAa
  , figGABAe
  , align = "v", axis = "l"
)

figGABA2ndCol <- cowplot::align_plots(
  figGABAb
  , figGABAf
  , align = "v", axis = "l"
)

# eventually 3rd col

figGABA1stRow <- plot_grid(
  figGABA1stCol[[1]]
  , figGABA2ndCol[[1]]
  , figGABAc
  , figGABAd
  , ncol = 4
  , labels = c("A", "B", "C", "D")
  , label_fontfamily = "Arial"
  , label_size = textSize
  , align = "h"
  , axis = "bt"
)

figGABA2ndRow <- plot_grid(
  figGABA1stCol[[2]]
  , figGABA2ndCol[[2]]
  , NULL
  , ncol = 3
  , labels = c("E", "F", "G - avg trace?")
  , label_fontfamily = "Arial"
  , label_size = textSize
  , align = "h"
  , axis = "bt"
  , rel_widths = c(1, 1, 2)
)

figGABA <- plot_grid(
  figGABA1stRow
  , figGABA2ndRow
  , nrow = 2
  # , rel_heights = c(2, 3)
)

figGABA
```

```{r}
flexSave(
  "figGABA"
  , plot = figGABA
  , width = twoCols
  # , height = 28/2
  , height = 28/3*2
  , units = "cm"
)
```

# Dams

## Number of exits

### Means

```{r}
damBehavior_byPND %>%
  group_by(
    PND, earlyLifeTrt
  ) %>%
  meanSummary(
    Num_exits
  )
```

### Stats

StatQ: 
- Is there a way to deal with the difference in variance?
- How to interpret the overall model - is it just that exits increase with LBN and decrease with day? No significant interaction
  - Should there be any post-hoc tests?
  - Why is the emmeans test significant, while the factor interactions aren't? Is it because the emmeans comparisons pull together the overall effect of LBN into the day comparisons?
  - Variance isn't equal between the groups


```{r}
lmm <- damBehavior_byPND %>%
  makeFactors(PND) %>%
  runLMM(
    Num_exits ~ earlyLifeTrt * PND + (1|damID)
  )

summary(lmm$model)

EMM <- emmeans(
  lmm$model
  , ~ earlyLifeTrt * PND
)
EMM

test(pairs(EMM, simple = "earlyLifeTrt"), by = NULL, adjust = "bonferroni")
```

```{r}
# doesn't work because "quasi" families cannot be used in glmer
# glmer(Num_exits ~ earlyLifeTrt * PND + (1|damID), data = damBehavior_byPND %>% makeFactors(PND), family = "quasipoisson")


# non-integers when averaged
# glmer(Num_exits ~ earlyLifeTrt * PND + (1|damID), data = damBehavior_byPND %>% makeFactors(PND), family = "poisson")


# StatQ:
# Does this sort of accomplish the averaging?
m <- glmer(Num_exits ~ earlyLifeTrt * PND + (1|damID), data = damBehavior_byPND_ZT %>% makeFactors(c(PND, ZT)), family = "poisson", nAGQ = 0)
summary(m)

EMM <- emmeans(
  m
  , ~ earlyLifeTrt * PND
  , type = "response"
)
EMM

test(pairs(EMM, simple = "earlyLifeTrt"), by = NULL, adjust = "bonferroni")
```

Question - how to analyze the GLMM as an "ANOVA"? It's really a chi-squared distribution

```{r}

m %>% getLMM_ANOVA()

Anova(m, type = 3)
anova(m, type = 3)
```

```{r}

```

```{r}
library(ggeffects)
```

### Behavior plot

```{r}
figDamsB
```

### Plotting the poisson distribution mean/95% CI over the mean/SE from the plot itself

Note that the generalized linear mixed effects wasn't run on the already averaged data because it needs the integer counts in order to use a poisson distribution. 

Added the se (manual subtract/add from the predicted value), to plot instead of the default confidence interval
StatQ: This seems to be smaller than what's calculated with the SE of the averaged data. 


However, just by eye, it seems to be a pretty good approximation of the actual data
```{r}
dfGroupLine <- EMM %>%
  as_data_frame() %>%
  rename(
    predicted = "rate"
  ) %>%
  mutate(
    se.low = predicted - SE
    , se.high = predicted + SE
  )

dfGroupLine

damBehavior_byPND %>%
  filter(
    !is.na(Num_exits)
  ) %>%
  plotDamBehavior(
    yVar = Num_exits
    , yLab = "# of exits"
    , fontSize = 16
    , addTriangleForMean = FALSE
    , colorByDam = TRUE
    , showMean = TRUE
    , addVertError = TRUE
  ) + geom_errorbar(
    aes(
      x = PND
      , ymin = predicted
      , ymax = predicted
    )
    , data = dfGroupLine %>%
      mutate(
        PND = as.numeric(paste(PND))
      )
    , inherit.aes = FALSE
    , width = 0.8
    , size = 0.4
    , color = "red"
  ) + geom_linerange(
    aes(
      x = PND
      , ymin = se.low
      , ymax = se.high
      # , ymin = conf.low
      # , ymax = conf.high
    )
    , data = dfGroupLine %>%
      mutate(
        PND = as.numeric(paste(PND))
      )
    , inherit.aes = FALSE
    , size = 0.4
    , color = "red"
  )
```


## Dam mass

### Means

```{r}
damMassFiltered %>%
  rename(
    PND = day
  ) %>%
  group_by(
    PND, earlyLifeTrt
  ) %>%
  meanSummary(
    mass
  )
```

### stats

```{r}
lmm <- damMassFiltered %>%
  rename(PND = day) %>%
  makeFactors(PND) %>%
  runLMM(
    mass ~ earlyLifeTrt * PND + (1|damID)
  )

summary(lmm$model)

lmm$anova %>% formatLMM_anova()

EMM <- emmeans(
  lmm$model
  , ~ earlyLifeTrt * PND
)
EMM

test(pairs(EMM, simple = "earlyLifeTrt"), by = NULL, adjust = "bonferroni")
```

### Plot

```{r}
Group_line <- ggemmeans(
  lmm$model
  , c("PND", "earlyLifeTrt")
)

dfGroupLine <- Group_line %>%
  as.data.frame() %>%
  rename(
    PND = x
    , earlyLifeTrt = group
  ) %>%
  mutate(
    se.low = predicted - std.error
    , se.high = predicted + std.error
  )

dfGroupLine

figDamsC + geom_errorbar(
    aes(
      x = PND
      , ymin = predicted
      , ymax = predicted
    )
    , data = dfGroupLine %>%
      mutate(
        PND = as.numeric(paste(PND))
      )
    , inherit.aes = FALSE
    , width = 0.8
    , size = 0.4
    , color = "red"
  ) + geom_linerange(
    aes(
      x = PND
      , ymin = se.low
      , ymax = se.high
      # , ymin = conf.low
      # , ymax = conf.high
    )
    , data = dfGroupLine %>%
      mutate(
        PND = as.numeric(paste(PND))
      )
    , inherit.aes = FALSE
    , size = 0.4
    , color = "red"
  )
```


## Dam corticosterone

### Means

```{r}
damFiltered %>%
  group_by(
    earlyLifeTrt
  ) %>%
  meanSummary(
    Cort_dam_P11
  )
```

### Stats

```{r}
damFiltered %>%
  t_test(
    Cort_dam_P11 ~ earlyLifeTrt
  )
```

## Offspring maturation

### Mass

#### Means

```{r}
mass_long %>%
  filter(
    day %in% c(11, 21, 35, 70)
  ) %>%
  group_by(
    sex
    , day
    , earlyLifeTrt
  ) %>%
  meanSummary(
    mass
  )
```

#### Stats

StatQ:
- Should mass for males and females be analyzed separately?
- How to interpret the lspline results?
  - Interaction with trt and some of the splines, but then not different w/ emmeans
  - Slope is different but not different any the specific time points?
  
##### females

```{r}
lmm <- mass_long %>%
  filter(
    day >= 11
    , sex == "F"
  ) %>%
  mutate(
    # day = day - 11
  ) %>%
  runLMM(
    mass ~ earlyLifeTrt * lspline(day, c(21, 35)) + (1|damID) + (1|mouseID)
    , printSummary = TRUE
  )

lmm$coefs %>% formatLMM_ppt()
```

```{r}

EMM <- emmeans(
  lmm$model
  , ~ earlyLifeTrt * lspline(day, c(21, 35))
  , data = mass_long %>%
  filter(
    day >= 11
  )
  , at = list(day = c(11, 21, 35, 70))
)
EMM

# This works to correct for 8 comparisons - when PND is a factor variable

test(pairs(EMM, simple = "earlyLifeTrt"), by = NULL, adjust = "bonferroni")
```

##### males

```{r}
lmm <- mass_long %>%
  filter(
    day >= 11
    , sex == "M"
  ) %>%
  mutate(
    # day = day - 11
  ) %>%
  runLMM(
    mass ~ earlyLifeTrt * lspline(day, c(21, 35)) + (1|damID) + (1|mouseID)
    , printSummary = TRUE
  )

lmm$coefs %>% formatLMM_ppt()
```

```{r}

EMM <- emmeans(
  lmm$model
  , ~ earlyLifeTrt * lspline(day, c(21, 35))
  , data = mass_long %>%
  filter(
    day >= 11
  )
  , at = list(day = c(11, 21, 35, 70))
)
EMM

# This works to correct for 8 comparisons - when PND is a factor variable

test(pairs(EMM, simple = "earlyLifeTrt"), by = NULL, adjust = "bonferroni")
```

## Vaginal Opening + First Estrus

### means

```{r}
maturationFiltered %>%
  group_by(
    earlyLifeTrt
  ) %>%
  meanSummary(
    c(
      VO_age
      , VO_mass
      , Estrus_age
      , Estrus_mass
    )
  )
```

### stats

StatQ:
- How to plot and show the data to match the LMM
  - Currently plotted by showing average for each litter as a dot
  - What about mean + SEM?
  
#### VO age

```{r}
lmm_age <- maturationFiltered %>%
  filter(
    sex == "F"
  ) %>%
  runLMM(
    VO_age ~ earlyLifeTrt + (1|damID)
    , printSummary = TRUE
  )

lmm_age$formated
lmm_age$anova
```

#### VO mass

```{r}
lmm_mass <- maturationFiltered %>%
  filter(
    sex == "F"
  ) %>%
  runLMM(
    VO_mass ~ earlyLifeTrt + (1|damID)
    , printSummary = TRUE
  )

lmm_mass$formated
lmm_mass$anova
```
#### First estrus age

```{r}
lmm_age <- maturationFiltered %>%
  filter(
    sex == "F"
  ) %>%
  runLMM(
    Estrus_age ~ earlyLifeTrt + (1|damID)
    , printSummary = TRUE
  )

lmm_age$formated
lmm_age$anova
```

#### First estrus mass

```{r}
lmm_mass <- maturationFiltered %>%
  filter(
    sex == "F"
  ) %>%
  runLMM(
    Estrus_mass ~ earlyLifeTrt + (1|damID)
    , printSummary = TRUE
  )

lmm_mass$formated
lmm_mass$anova
```

## Preputial separation

### means

```{r}
maturationFiltered %>%
  group_by(
    earlyLifeTrt
  ) %>%
  meanSummary(
    c(
      PreputialSep_age
      , PreputialSep_mass
    )
  )
```


#### Preputial separation age

```{r}
lmm_age <- maturationFiltered %>%
  filter(
    sex == "M"
  ) %>%
  runLMM(
    PreputialSep_age ~ earlyLifeTrt + (1|damID)
    , printSummary = TRUE
  )

lmm_age$formated
lmm_age$anova
```

#### Preputial separation mass

```{r}
lmm_mass <- maturationFiltered %>%
  filter(
    sex == "M"
  ) %>%
  runLMM(
    PreputialSep_mass ~ earlyLifeTrt + (1|damID)
    , printSummary = TRUE
  )

lmm_mass$formated
lmm_mass$anova
```
# Estrous cycles

```{r}

```

