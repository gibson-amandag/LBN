---
title: "AGG LBN Data Update - 2022"
output: html_notebook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
# options(digits=3)
```

```{r include=FALSE}
source("./01-scripts/01-set-up.R")
source(file.path(scriptsFolder, "02-get-datasets.R"))
```

```{r}
doc.type <- knitr::opts_knit$get('rmarkdown.pandoc.to')
```

```{r}
litterNum_label <- c(
  "1" = "first litter",
  "2" = "second litter"
)

facetForLitterNum <- facet_grid(
    cols = vars(litterNum),
    labeller = labeller(
      litterNum = litterNum_label
    )
  )

figureNum <- 1

pptBaseName <- function(figNum) {
  baseName = paste0(figNum, "_")
  return(baseName)
}

plotFolder <- file.path(plotOutputFolder, "LBN_Fall2022")
subFolder <- "LBN_Fall2022"

imgType <-"PNG"
```

```{r}
# make powerpoint and title slide
ppt <- read_pptx("genericPPT.pptx")
ppt <- add_slide(ppt, layout = "Title Slide")
ppt <- ph_with(
  ppt,
  value = paste("LBN data on", Sys.Date()),
  location = ph_location_label("Title 1")
)

savePPT <- function(){
  print(ppt, target = file.path(plotFolder, paste0("AGG_LBN_data_", Sys.Date(), ".pptx")))
}
```

# Cohort Information

-   Cohort 1

    -   CBA and B6 dams

    -   P2-P9

All later cohorts are CBA dams, P4-P11

-   Cohort 2
    -   First litter
    -   Winter 2021
    -   Females diestrous cort
-   Cohort 3
    -   First litter
    -   Used for body mass / maturation judgments
    -   Not included in data in this report, as different amounts of handling of offspring
    -   Dams rebred for Cohort 4
-   Cohort 4
    -   Second litter
    -   Spring/summer 2021
    -   Females proestrous cort/LH
-   Cohort 5
    -   Used for body mass/maturation judgments
    -   Used for determining proestrus
    -   Not included in data in this report
    -   Dams rebred for Cohort 6
-   Cohort 6
    -   Second litter
    -   Spring/summer 2021
    -   Females proestrous cort/LH and diestrous cort/LH
-   Cohort 7
    -   First litter
    -   Fall 2021/Winter 2022
    -   Females proestrous cort/LH (to 0.5h after ALPS) then GABA recordings
-   Cohort 8
    -   Second litter
    -   Fall 2021/Winter 2022
    -   Females diestrous cort/LH
-   Cohort 9
    -   Fall 2022/Winter 2023
    -   Females to be used for
        -   Proestrous cort/LH to 2h after lights out

        -   GABA recordings

        -   Excitability of GnRH neurons

```{r}
slideTitle <- "Cohort Information"

listLevels <- c(
  1, 2, 2,
  1, 2, 2, 2, 2, 
  1, 2, 2, 2, 
  1, 2, 2, 2, 2,
  1, 2, 2, 2,
  1, 2, 2, 2,
  1, 2, 2, 2,
  1, 2, 2, 2, 2, 2
  )
slideText <- block_list(
  makeBullet("Cohort 2"),
    makeBullet("Winter 2021"),
    makeBullet("Females diestrous cort"),
  makeBullet("Cohort 3"),
    makeBullet("First litter"),
    makeBullet("Used for body mass / maturation judgments"),
    makeBullet("Not included in data in this report, as different amounts of handling of offspring"),
    makeBullet("Dams rebred for Cohort 4"),
  makeBullet("Cohort 4"),
    makeBullet("Second litter"),
    makeBullet("Spring/summer 2021"),
    makeBullet("Females proestrous cort/LH"),
  makeBullet("Cohort 5"),
    makeBullet("Used for body mass/maturation judgments"),
    makeBullet("Used for determining proestrus"),
    makeBullet("Not included in data in this report"),
    makeBullet("Dams rebred for Cohort 6"),
  makeBullet("Cohort 6"),
    makeBullet("Second litter"),
    makeBullet("Spring/summer 2021"),
    makeBullet("Females proestrous cort/LH and diestrous cort/LH"),
  makeBullet("Cohort 7"),
    makeBullet("First litter"),
    makeBullet("Fall 2021/Winter 2022"),
    makeBullet("Females proestrous cort/LH (to 0.5h after ALPS) then GABA recordings"),
  makeBullet("Cohort 8"),
    makeBullet("Second litter"),
    makeBullet("Fall 2021/Winter 2022"),
    makeBullet("Females diestrous cort/LH"),
  makeBullet("Cohort 9"),
    makeBullet("Fall 2022/Winter 2023"),
    makeBullet("Females to be used for"),
    makeBullet("Proestrous cort/LH to 2h after lights out"),
    makeBullet("GABA recordings"),
    makeBullet("Excitability of GnRH neurons")
)

ppt <- addSlide_text(
  ppt,
  slideTitle,
  slideText,
  listLevels
)
```

```{r}
cohorts <- c(2, 4, 6, 7, 8, 9)
dataFilter <- function(df){
  df %>%
    filter(
      Litter_size_startPara >= 5,
      cohort %in% cohorts
    )
}
```

# Dam Behavior

## ZT1 and ZT15

Based on feedback from Jessica Bolton, they analyze starting 1h after light transitions.

For Cohort 9, we have video monitoring for the full P4-P11 period

```{r}
slideTitle <- "ZT1 and ZT15"


listLevels <- c(
  1, 1
  )
slideText <- block_list(
  makeBullet("Based on feedback from Jessica Bolton, they analyze starting 1h after light transitions"),
  makeBullet("For Cohort 9, we have video monitoring for the full P4-P11 period")
)

ppt <- addSlide_text(
  ppt,
  slideTitle,
  slideText,
  listLevels
)
```

```{r}
# behaviorTimeHours = c(12, 14, 16, 18, 20, 22, 0, 2, 4)
behaviorTimeHours = c(1, 15)
dam_behavior_filtered <- dam_behavior %>%
  dataFilter() %>%
  filter(
    time %in% behaviorTimeHours
  ) %>%
  mutate(
    firstDay = ifelse(
      damID == "D015", 
      FALSE, 
      ifelse(
        (cohort == 2 | cohort == 4 | cohort == 6), 
        TRUE, 
        ifelse(
          damID == "D051-01",
          TRUE,
          FALSE
        )
      )
    )
  )
```

```{r}
# install.packages("lemon")
library(lemon)
```

### First litters

```{r include=FALSE}
behaviorOverTime <- dam_behavior_filtered %>%
  filter(
    litterNum == 1
  ) %>%
  behavior_overTime_days(
    yVar = Num_exits,
    yLab = "# of exits / hour",
    fontSize = 16,
    dotSize = 3,
    dotSize_byFirstDay = FALSE,
    lineSize = 0.75
  )
plot <- behaviorOverTime +
  # facet_wrap(
  #   ~ earlyLifeTrt,
  #   ncol = 2,
  #   labeller = labeller(
  #     litterNum = litterNum_label
  #   ),
  #   scales = "free"
  # )+
  theme(
    legend.position = "bottom"
    # , axis.title.x = element_blank()
  ) +
  guides(
    fill = "none"
    , linetype = "none"
  )+
  labs(
    x = "ZT hour"
  ) +
  expand_limits(y = 70)#+
  # expand_limits(x = c(as_datetime(ymd_h("2000-01-4 15")), as_datetime(ymd_h("2000-01-11 1"))))

fileBaseName <- "damBehavior_firstLitter"
thisWidth = 11.5
thisHeight = 5
thisUnits = "in"

flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = plot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
)
```

```{r echo=FALSE}
plot
ppt <- addSlide_oneGraph(
  ppt,
  "Effect of LBN on naive dam behavior over time",
  plot
)
```

### Second litters

```{r include=FALSE}
behaviorOverTime <- dam_behavior_filtered %>%
  filter(
    litterNum == 2
  ) %>%
  behavior_overTime_days(
    yVar = Num_exits,
    yLab = "# of exits / hour",
    fontSize = 16,
    dotSize = 3,
    dotSize_byFirstDay = FALSE,
    lineSize = 0.75,
    addTriangleForMean = TRUE
  )
plot <- behaviorOverTime +
  # facet_wrap(
  #   ~ earlyLifeTrt,
  #   ncol = 2,
  #   labeller = labeller(
  #     litterNum = litterNum_label
  #   ),
  #   scales = "free"
  # )+
  theme(
    legend.position = "bottom"
    # , axis.title.x = element_blank()
  ) +
  guides(
    fill = "none"
    , linetype = "none"
  )+
  labs(
    x = "ZT hour"
  ) +
  expand_limits(y = 70)#+
  # expand_limits(x = c(as_datetime(ymd_h("2000-01-4 15")), as_datetime(ymd_h("2000-01-11 1"))))

fileBaseName <- "damBehavior_secondLitter"
thisWidth = 11.5
thisHeight = 5
thisUnits = "in"

flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = plot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
)
```

```{r echo=FALSE}
plot
ppt <- addSlide_oneGraph(
  ppt,
  "Effect of LBN on experienced dam behavior over time",
  plot
)
```

## P5-P6 analysis

I've analyzed additional times for P5-P6 analysis across cohorts 2, 4, 6, 7, 8

```{r}
slideTitle <- "P5-P6 Analysis"


listLevels <- c(
  1
  )
slideText <- block_list(
  makeBullet("I've analyzed additional times for P5-P6 analysis across cohorts 2, 4, 6, 7, 8")
)

ppt <- addSlide_text(
  ppt,
  slideTitle,
  slideText,
  listLevels
)
```

```{r}
dam_behavior_filtered <- dam_behavior %>%
  dataFilter() %>%
  filter(
    PND %in% c(5, 6),
    ! (PND == 5 & time == 1),
    ! (PND == 6 & time == 15)
    # ,time %in% behaviorTimeHours
  ) %>%
  mutate(
    firstDay = ifelse(
      damID == "D015", 
      FALSE, 
      ifelse(
        (cohort == 2 | cohort == 4 | cohort == 6), 
        TRUE, 
        ifelse(
          damID == "D051-01",
          TRUE,
          FALSE
        )
      )
    )
  )
```

### First litters

```{r}
behaviorOverTime <- dam_behavior_filtered %>%
  filter(
    litterNum == 1
  ) %>%
  behavior_overTime_days(
    yVar = Num_exits,
    yLab = "# of exits / hour",
    fontSize = 16,
    dotSize = 3,
    dotSize_byFirstDay = FALSE,
    lineSize = 0.75,
    addTriangleForMean = TRUE,
    redMean = TRUE
  )
plot <- behaviorOverTime +
  facet_wrap(
    ~ earlyLifeTrt,
    ncol = 2,
    labeller = labeller(
      litterNum = litterNum_label
    ),
    scales = "free"
  )+
  theme(
    legend.position = "bottom"
    # , axis.title.x = element_blank()
  ) +
  guides(
    fill = "none"
    , linetype = "none"
  )+
  labs(
    x = "ZT hour"
  ) +
  expand_limits(y = 70) + 
  scale_x_datetime(
    breaks = c(
        as_datetime(ymd_h("2000-01-05 14")),
        as_datetime(ymd_h("2000-01-05 19")),
        as_datetime(ymd_h("2000-01-06 0")),
        as_datetime(ymd_h("2000-01-06 4"))
      ), 
    date_labels = "%d\n%H"
  )

fileBaseName <- "damBehavior_firstLitter_all"
thisWidth = 11.5
thisHeight = 5
thisUnits = "in"

flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = plot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
)
```

```{r echo=FALSE}
plot 
ppt <- addSlide_oneGraph(
  ppt,
  "Effect of LBN on naive dam behavior P5-P6",
  plot
)
```

### Second litters

```{r}
behaviorOverTime <- dam_behavior_filtered %>%
  filter(
    litterNum == 2
  ) %>%
  behavior_overTime_days(
    yVar = Num_exits,
    yLab = "# of exits / hour",
    fontSize = 16,
    dotSize = 3,
    dotSize_byFirstDay = FALSE,
    lineSize = 0.75,
    addTriangleForMean = TRUE,
    redMean = TRUE
  )
plot <- behaviorOverTime +
  facet_wrap(
    ~ earlyLifeTrt,
    ncol = 2,
    labeller = labeller(
      litterNum = litterNum_label
    ),
    scales = "free"
  )+
  theme(
    legend.position = "bottom"
    # , axis.title.x = element_blank()
  ) +
  guides(
    fill = "none"
    , linetype = "none"
  )+
  labs(
    x = "ZT hour"
  ) +
  expand_limits(y = 70) + 
  scale_x_datetime(
    breaks = c(
        as_datetime(ymd_h("2000-01-05 14")),
        as_datetime(ymd_h("2000-01-05 19")),
        as_datetime(ymd_h("2000-01-06 0")),
        as_datetime(ymd_h("2000-01-06 4"))
      ), 
    date_labels = "%d\n%H"
  )

fileBaseName <- "damBehavior_secondLitter_all"
thisWidth = 11.5
thisHeight = 5
thisUnits = "in"

flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = plot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
)
```

```{r echo=FALSE}
plot
ppt <- addSlide_oneGraph(
  ppt,
  "Effect of LBN on experienced dam behavior P5-P6",
  plot
)
```

## ANOVA

Ultimately, if we focus on ZT1 and ZT15, could do a three-way ANOVA of

-   Treatment

    -   STD vs LBN

-   Day

    -   PND4-11

-   Time

    -   ZT1 ZT15

We wouldn't be able to look at first litter versus second litter with this analysis, though. Ultimately, we may be able to compare how the PND5 ZT15 and PND6 ZT1 times compare with the new, prolonged recordings, compared to the original, limited recordings.

The biggest difference I've seen still appears to be at the ZT19 time, which may still be worth also analyzing for the new recordings

```{r}
slideTitle <- "Behavior analysis"


listLevels <- c(
  1,1, 1
  )
slideText <- block_list(
  makeBullet("Ultimately, if we focus on ZT1 and ZT15, could do a three-way ANOVA of treatment (STD vs LBN), time (ZT1 vs ZT15), day (P4-P11). We wouldn't be able to compare second litter behavior with this analysis, though, because we only have P5 ZT15 and P6 ZT1."),
  makeBullet("we may be able to compare how the PND5 ZT15 and PND6 ZT1 times compare with the new, prolonged recordings, compared to the original, limited recordings."),
  makeBullet("The biggest difference I've seen still appears to be at the ZT19 time, which may still be worth also analyzing for the new recordings")
)

ppt <- addSlide_text(
  ppt,
  slideTitle,
  slideText,
  listLevels
)
```

```{r eval=FALSE, include=FALSE}

damBehaviorAnova <- dam_behavior_filtered %>%
  anova_test(
    dv = Num_exits,
    wid = damID,
    between = c(earlyLifeTrt, litterNum),
    within = c(time)
  ) 

damBehaviorAnova$ANOVA%>%
  myDisplay()

dam_behavior_filtered %>%
  group_by(
    time
  ) %>%
  anova_test(
    dv = Num_exits,
    between = c(earlyLifeTrt)
  ) %>%
  adjust_pvalue(method = "bonferroni")
```

```{r}
# 1 -> 2
figureNum <- figureNum + 1
```

# Dam Corticosterone

```{r}
P11_cortDams <- Demo_dam %>%
  dataFilter() %>%
  filter(
    !is.na(Cort_dam_P11)
  )

plot <- P11_cortDams %>%
  scatterPlotLBN(
    yVar = Cort_dam_P11,
    yLab = "corticosterone (ng/mL)",
    textSize = 16,
    dotSize = 3,
    zoom_y = TRUE,
    ymin = 0,
    ymax = 120
  ) + 
  facetForLitterNum

imgType = "png"
thisWidth = 11
thisHeight = 5.5
thisUnits = "in"

fileBaseName = "DamCort_P11"

flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = plot,
  fileType = imgType,
  filePath = plotFolder,
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)


```

```{r echo=FALSE}
plot
ppt <- addSlide_oneGraph(
  ppt,
  "Effect of LBN on dam corticosterone on P11",
  plot
)
```

```{r echo=FALSE}
ppt <- addSlide_oneTable(
  ppt,
  "Effect of LBN on dam corticosterone on P11",
  P11_cortDams %>%
  anova_test(
    dv = Cort_dam_P11,
    between = c(litterNum, earlyLifeTrt)
  )
)
```

```{r}
# 2 -> 3
figureNum <- figureNum + 1
```

# Body mass

```{r include=FALSE}
massDF <- Mass_off %>%
  dataFilter()

massDF
```

## First litter

```{r}
thisGroupByDam = TRUE
facetBySex = TRUE
useLineType = FALSE
individualLines = TRUE
meanLines = TRUE
zoom_x = FALSE
zoom_x_min = 0
zoom_x_max = 21
zoom_y = TRUE
zoom_y_min = 0
zoom_y_max = 35
indivAlpha = .3
meanAlpha = 1
errorBarAlpha = 1
fontSize = 16
STDColor = "#4D4D4D"
LBNColor = "#008B8B"

fileBaseName = "mass_litter1"
imgType = "png"
thisWidth = 11.5
thisHeight = 5
thisUnits = "in"

df <- massDF %>%
  filter(
    litterNum == 1
  )

groupVar <- ifelse(thisGroupByDam, expr(damID), expr(mouseID))

plot <- df %>%
  plot_mass_lines(
    groupByDam = thisGroupByDam,
    facetBySex = facetBySex,
    useLineType = useLineType, # TRUE/FALSE
    lineTypeVar = earlyLifeTrt,
    lineGroupVar = {{ groupVar }},
    xtitle = "postnatal day", #x axis label
    ytitle = "mass (g)", #y axis label
    title = NULL, # plot title
    individualLines = individualLines, # plot individual lines
    meanLines = meanLines, # plot mean lines with SE
    zoom_x = zoom_x, # Zoom to part of x axis
    xmin = zoom_x_min,
    xmax = zoom_x_max,
    zoom_y = zoom_y, # Zoom to part of y axis
    ymin = zoom_y_min,
    ymax = zoom_y_max,
    indivLineAlpha = indivAlpha,
    indivLineSize = 0.8,
    errorBarWidth = 0,
    meanLineSize = 1.4,
    meanAlpha = meanAlpha,
    errorBarSize = 1,
    # errorBarColor = "grey10",
    errorBarAlpha = errorBarAlpha,
    textSize = fontSize,
    axisSize = 0.5,
    # legendPosition = "bottom",
    legendPosition = c(0.85, 0.2),
    STDColor = STDColor,
    LBNColor = LBNColor
  ) +
  # facet_wrap(
  #   ~ damStrain
  # ) +
  theme(
    legend.key = element_rect(fill = NA)
  )


flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = plot,
  fileType = imgType,
  filePath = plotFolder,
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
```

```{r echo=FALSE}
plot
ppt <- addSlide_oneGraph(
  ppt,
  "Effect of LBN on body mass for first litter offspring",
  plot
)
```

## Second litter

```{r}
fileBaseName = "mass_litter2"
imgType = "png"
thisWidth = 11.5
thisHeight = 5
thisUnits = "in"

df <- massDF %>%
  filter(
    litterNum == 2
  )

groupVar <- ifelse(thisGroupByDam, expr(damID), expr(mouseID))

plot <- df %>%
  plot_mass_lines(
    groupByDam = thisGroupByDam,
    facetBySex = facetBySex,
    useLineType = useLineType, # TRUE/FALSE
    lineTypeVar = earlyLifeTrt,
    lineGroupVar = {{ groupVar }},
    xtitle = "postnatal day", #x axis label
    ytitle = "mass (g)", #y axis label
    title = NULL, # plot title
    individualLines = individualLines, # plot individual lines
    meanLines = meanLines, # plot mean lines with SE
    zoom_x = zoom_x, # Zoom to part of x axis
    xmin = zoom_x_min,
    xmax = zoom_x_max,
    zoom_y = zoom_y, # Zoom to part of y axis
    ymin = zoom_y_min,
    ymax = zoom_y_max,
    indivLineAlpha = indivAlpha,
    indivLineSize = 0.8,
    errorBarWidth = 0,
    meanLineSize = 1.4,
    meanAlpha = meanAlpha,
    errorBarSize = 1,
    # errorBarColor = "grey10",
    errorBarAlpha = errorBarAlpha,
    textSize = fontSize,
    axisSize = 0.5,
    # legendPosition = "bottom",
    legendPosition = c(0.85, 0.2),
    STDColor = STDColor,
    LBNColor = LBNColor
  ) +
  # facet_wrap(
  #   ~ damStrain
  # ) +
  theme(
    legend.key = element_rect(fill = NA)
  )

flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = plot,
  fileType = imgType,
  filePath = plotFolder,
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
```

```{r echo=FALSE}
plot
ppt <- addSlide_oneGraph(
  ppt,
  "Effect of LBN on body mass for second litter offspring",
  plot
)
```

```{r}
massDF_long <- massDF %>%
  makeOffMassLong()

massDF_byDam <- massDF %>%
    getAvgByDam(bySex = facetBySex)

massDF_byDam_long <- massDF_byDam %>%
  makeOffMassLong()
```

## Linear mixed effects model

I've divided up the mass data into three epochs that are roughly linear looking on the graphs

-   P11-P21

-   P22-P35

-   P42-P72

I think that the linear mixed effects model is more appropriate than an ANOVA here because it takes into account the "meaning" of time (age), and we can incorporate all of the mass data without having an absurd number of comparisons as would be required with an ANOVA

```{r}
slideTitle <- "Mass linear mixed effects model"


listLevels <- c(
  1, 2, 2, 2, 
  1
  )
slideText <- block_list(
  makeBullet("I've divided up the mass data into three epochs that are roughly linear looking on the graphs"),
  makeBullet("P11-P21"),
  makeBullet("P22-P35"),
  makeBullet("P42-P72"),
  makeBullet("I think that the linear mixed effects model is more appropriate than an ANOVA here because it takes into account the \"meaning\" of time (age), and we can incorporate all of the mass data without having an absurd number of comparisons as would be required with an ANOVA")
)

ppt <- addSlide_text(
  ppt,
  slideTitle,
  slideText,
  listLevels
)
```

```{r include=FALSE}
library("lmerTest")
library("lme4")
library("emmeans")
```

## Before weaning

```{r}
preWeanMass_mod <- lmer(
  mass ~ earlyLifeTrt*sex*day + Litter_size + litterNum + (1 | damID),
  data = massDF_long %>% 
    mutate(Litter_size = as.integer(Litter_size)) %>% 
    filter(
      day > 4,
      day <= 21
    ) %>%
    mutate(
      day = day - 11 # make it so that day 11 is 0 so intercept makes sense
    )
)
summary(preWeanMass_mod)
anova(preWeanMass_mod)


# https://stats.stackexchange.com/questions/331238/post-hoc-pairwise-comparison-of-interaction-in-mixed-effects-lmer-model
# Don't know how to do the post-hoc here because day is a numeric variable

# emm = emmeans(preWeanMass_mod, ~ earlyLifeTrt * sex * day)
emm = emmeans(preWeanMass_mod, ~ earlyLifeTrt * sex)
pairs(emm, simple = "each")
```

There's a three-way interaction between age, sex, and early-life treatment before weaning. However, I don't know how to do the post-hoc analysis for this, because day is a continuous, numeric variable and not a discrete factor. For that reason, I've done the two-way comparison for now, but will need to return to this.

```{r}
ppt <- ppt %>%
  addSlide_oneTable(
    "Effect of LBN on body mass before weaning",
    anova(preWeanMass_mod) %>% as_tibble(rownames = " ")
  )
```

```{r}
slideTitle <- "Pre-weaning mass linear mixed effects model"


listLevels <- c(
  1
  )
slideText <- block_list(
  makeBullet("There's a three-way interaction between age, sex, and early-life treatment before weaning. However, I don't know how to do the post-hoc analysis for this, because day is a continuous, numeric variable and not a discrete factor. For that reason, I've done the two-way comparison for now, but will need to return to this.")
)

ppt <- addSlide_text(
  ppt,
  slideTitle,
  slideText,
  listLevels
)
```

```{r eval=FALSE, include=FALSE}
ppt <- ppt %>%
  addSlide_oneTable(
    "Effect of LBN on body mass before weaning",
    emmPairs %>% as.data.frame()
  )
```

## 22 to 35

```{r}
postWeanMass_mod <- lmer(
  mass ~ earlyLifeTrt*sex*day + Litter_size + litterNum + (1 | damID),
  data = massDF_long %>% 
    mutate(Litter_size = as.integer(Litter_size)) %>% 
    filter(
      day > 21,
      day <= 35
    )
)
summary(postWeanMass_mod)
anova(postWeanMass_mod)


# https://stats.stackexchange.com/questions/331238/post-hoc-pairwise-comparison-of-interaction-in-mixed-effects-lmer-model
emm = emmeans(postWeanMass_mod, ~ earlyLifeTrt * sex)
emmPairs <- pairs(emm, simple = "each")
emmPairs

```

```{r}
ppt <- ppt %>%
  addSlide_oneTable(
    "Effect of LBN on body mass P22-P35",
    anova(postWeanMass_mod) %>% as_tibble(rownames = " ")
  )
```

```{r}
ppt <- ppt %>%
  addSlide_oneTable(
    "Effect of LBN on body mass P22-P35",
    emmPairs %>% as.data.frame()
  )
```

## P42 to P72

There are no differences by early-life treatment at this age

```{r}
adultMass_mod <- lmer(
  mass ~ earlyLifeTrt*sex*day + Litter_size + litterNum + (1 | damID),
  data = massDF_long %>% 
    mutate(Litter_size = as.integer(Litter_size)) %>% 
    filter(
      day > 35
    )
)
summary(adultMass_mod)
anova(adultMass_mod)
```

```{r}
ppt <- ppt %>%
  addSlide_oneTable(
    "Effect of LBN on body mass P42-P72",
    anova(adultMass_mod) %>% as_tibble(rownames = " ")
  )
```

```{r}
slideTitle <- "Adult mass linear mixed effects model"


listLevels <- c(
  1
  )
slideText <- block_list(
  makeBullet("There are no differences by early-life treatment at this age")
)

ppt <- addSlide_text(
  ppt,
  slideTitle,
  slideText,
  listLevels
)
```

```{r}
# 3 -> 4
figureNum <- figureNum + 1
```

# Maturation

```{r}
maturationFiltered <- Maturation_off %>%
  dataFilter()

df_females <- maturationFiltered %>%
  filter(
    sex == "F"
  ) %>%
  getAvgByDam()

df_males <- maturationFiltered %>%
  filter(
    sex == "M"
  ) %>%
  getAvgByDam()
```

```{r}
imgType = "png"
thisWidth = 4
thisHeight = 5.5
thisUnits = "in"
fontSize = 16
thisDotSize = 3
```

```{r}
VO_age_plot <- df_females %>%
  scatterPlotLBN(yVar = VO_age, "age at vaginal opening (days)", textSize = fontSize, dotSize = thisDotSize)
max_VO_age <- df_females$VO_age %>% max(na.rm = TRUE)
```

```{r}
VO_mass_plot <- df_females %>%
  scatterPlotLBN(yVar = VO_mass, "mass at vaginal opening (g)", textSize = fontSize, dotSize = thisDotSize)
max_VO_mass <- df_females$VO_mass %>% max(na.rm = TRUE)
```

```{r}
Estrus_age_plot <- df_females %>%
  scatterPlotLBN(yVar = Estrus_age, "age at first estrus (days)", textSize = fontSize, dotSize = thisDotSize)
max_estrus_age <- df_females$Estrus_age %>% max(na.rm = TRUE)
```

```{r}
Estrus_mass_plot <- df_females %>%
  scatterPlotLBN(yVar = Estrus_mass, "mass at first estrus (g)", textSize = fontSize, dotSize = thisDotSize)
max_estrus_mass <- df_females$Estrus_mass %>% max(na.rm = TRUE)
```

```{r}
PreputialSep_age_plot <- df_males %>%
  scatterPlotLBN(yVar = PreputialSep_age, "age at preputial sep. (days)", textSize = fontSize, dotSize = thisDotSize)
max_PPS_age <- df_males$PreputialSep_age %>% max(na.rm = TRUE)
```

```{r}
PreputialSep_mass_plot <- df_males %>%
  scatterPlotLBN(yVar = PreputialSep_mass, "mass at preputial sep. (g)", textSize = fontSize, dotSize = thisDotSize)
max_PPS_mass <- df_males$PreputialSep_mass %>% max(na.rm = TRUE)
```

## ANOVAs
```{r}
VO_age_ANOVA <- df_females %>%
  anova_test(
    dv = VO_age,
    between = c(litterNum, earlyLifeTrt)
  )

Estrus_age_ANOVA <- df_females %>%
  anova_test(
    dv = Estrus_age,
    between = c(litterNum, earlyLifeTrt)
  )


PreputialSep_age_ANOVA <- df_males %>%
  anova_test(
    dv = PreputialSep_age,
    between = c(litterNum, earlyLifeTrt)
  )


VO_mass_ANOVA <- df_females %>%
  anova_test(
    dv = VO_mass,
    between = c(litterNum, earlyLifeTrt)
  )


Estrus_mass_ANOVA <- df_females %>%
  anova_test(
    dv = Estrus_mass,
    between = c(litterNum, earlyLifeTrt)
  )


PreputialSep_mass_ANOVA <- df_males %>%
  anova_test(
    dv = PreputialSep_mass,
    between = c(litterNum, earlyLifeTrt)
  )
```


## VO

```{r}
max_age <- max(max_VO_age, max_estrus_age, max_PPS_age, na.rm = TRUE) + 3
max_mass <- max(max_VO_mass, max_estrus_mass, max_PPS_mass, na.rm = TRUE) + 3

fileBaseName = "VO_age_litterNum"
plot = VO_age_plot + expand_limits(y = max_age) + facetForLitterNum
flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = plot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)

fileBaseName = "VO_mass_litterNum"
massPlot = VO_mass_plot + expand_limits(y = max_mass) + facetForLitterNum
flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = massPlot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
```

```{r}
plot
massPlot

ppt <- addSlide_twoGraph(
  ppt,
  "Vaginal opening",
  plot,
  massPlot
)

VO_age_ANOVA
VO_mass_ANOVA

ppt <- addSlide_oneTable(
  ppt,
  "Effect of LBN and experience on age at vaginal opening",
  VO_age_ANOVA %>% formatAnova(16),
  dontFormat=TRUE
)
ppt <- addSlide_oneTable(
  ppt,
  "Effect of LBN and experience on mass at vaginal opening",
  VO_mass_ANOVA %>% formatAnova(16),
  dontFormat=TRUE
)
```


### First Estrus

```{r}
fileBaseName = "Estrous_age_litterNum"
plot = Estrus_age_plot + expand_limits(y = max_age) + facetForLitterNum
flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = plot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)

fileBaseName = "Estrus_mass_litterNum"
massPlot = Estrus_mass_plot + expand_limits(y = max_mass) + facetForLitterNum
flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = massPlot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
```

```{r}
plot
massPlot

ppt <- addSlide_twoGraph(
  ppt,
  "First estrus",
  plot,
  massPlot
)

Estrus_age_ANOVA
Estrus_mass_ANOVA

ppt <- addSlide_oneTable(
  ppt,
  "Effect of LBN and experience on age at first estrus",
  Estrus_age_ANOVA %>% formatAnova(16),
  dontFormat=TRUE
)
ppt <- addSlide_oneTable(
  ppt,
  "Effect of LBN and experience on mass at first estrus",
  Estrus_mass_ANOVA %>% formatAnova(16),
  dontFormat=TRUE
)
```


### Preputial Separation

```{r}
fileBaseName = "PreputialSep_age_litterNum"
plot = PreputialSep_age_plot + expand_limits(y = max_age) + facetForLitterNum
flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = plot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)

fileBaseName = "PreputialSep_mass_litterNum"
massPlot = PreputialSep_mass_plot + expand_limits(y = max_mass) + facetForLitterNum
flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = massPlot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
```

```{r}
plot
massPlot

ppt <- addSlide_twoGraph(
  ppt,
  "Vaginal opening",
  plot,
  massPlot
)

PreputialSep_age_ANOVA
PreputialSep_mass_ANOVA

ppt <- addSlide_oneTable(
  ppt,
  "Effect of LBN and experience on age at preputial separation",
  PreputialSep_age_ANOVA %>% formatAnova(16),
  dontFormat=TRUE
)
ppt <- addSlide_oneTable(
  ppt,
  "Effect of LBN and experience on mass at preputial separation",
  PreputialSep_mass_ANOVA %>% formatAnova(16),
  dontFormat=TRUE
)
```

```{r}
# 4 -> 5
figureNum <- figureNum + 1
```

## Cumulative Frequency

```{r}
temp_cumFreq_geom <- function(
  zoom_x = FALSE, # Zoom to part of x axis
  xmin = NULL,
  xmax = NULL,
  zoom_y = FALSE, # Zoom to part of y axis
  ymin = NULL,
  ymax = NULL,
  textSize = 11,
  lineSize = 2
) {
  list(
    stat_ecdf(
      size = lineSize
      , geom = "line"
      , pad = FALSE
    ),
    stat_ecdf(
      geom = "point"
      , pad = FALSE
      ),
    coord_cartesian(if(zoom_x){xlim = c(xmin, xmax)}, if(zoom_y){ylim = c(ymin, ymax)}),
    textTheme(size = textSize),
    boxTheme()
  )
}

temp_cumFreq_plot <- function(
  df,
  phenoVar,
  phenotypeName,
  zoom_x = FALSE, # Zoom to part of x axis
  xmin = NULL,
  xmax = NULL,
  zoom_y = FALSE, # Zoom to part of y axis
  ymin = NULL,
  ymax = NULL,
  textSize = 11,
  lineSize = 1,
  STDColor = "grey30",
  LBNColor = "cyan4"
) {
  df %>%
    filter(!is.na({{ phenoVar }})) %>%
    ggplot(
      aes(
        {{ phenoVar }},
        color = earlyLifeTrt
      )
    ) +
    expand_limits(y = 0, x = 21) +
    temp_cumFreq_geom(
      zoom_x,
      xmin,
      xmax,
      zoom_y,
      ymin,
      ymax,
      textSize,
      lineSize
    ) +
    scale_y_continuous(
      labels = scales::percent
    ) +
    # scale_x_continuous(
    #   breaks = 
    # )
    earlyLifeColor(STDColor = STDColor, LBNColor = LBNColor) +
    labs(
      y = paste("cumulative % of", phenotypeName),
      x = "age (days)"
    ) + 
    theme(
      legend.key = element_rect(fill = NA),
      legend.position = c(0.8, 0.2)
    )
}
```

### First Litter

```{r}
thisLitterNum <- 1

VO_freqPlot <- df_females %>%
  filter(
    litterNum == thisLitterNum
  ) %>%
  temp_cumFreq_plot(
    VO_age,
    "vaginal opening",
    zoom_x = TRUE,
    xmin = 25,
    xmax = max_age,
    textSize = 16
  ) #+ 
  # facetForLitterNum

VO_freqPlot
Estrus_freqPlot <- df_females %>%
  filter(
    litterNum == thisLitterNum
  ) %>%
  temp_cumFreq_plot(
    Estrus_age,
    "first estrus",
    zoom_x = TRUE,
    xmin = 25,
    xmax = max_age,
    textSize = 16
  ) #+ 
  # facetForLitterNum

Estrus_freqPlot
PreputialSep_freqPlot <- df_males %>%
  filter(
    litterNum == thisLitterNum
  ) %>%
  temp_cumFreq_plot(
    PreputialSep_age,
    "preputial separation",
    zoom_x = TRUE,
    xmin = 25,
    xmax = max_age,
    textSize = 16
  ) #+ 
  # facetForLitterNum

PreputialSep_freqPlot

flexSave(
  baseName = "VO_freq_plot",
  thisFilePrefix = pptBaseName(paste0("_extra_", thisLitterNum)),
  plot = VO_freqPlot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
flexSave(
  baseName = "Estrus_freq_plot",
  thisFilePrefix = pptBaseName(paste0("_extra_", thisLitterNum)),
  plot = Estrus_freqPlot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
flexSave(
  baseName = "PPS_freq_plot",
  thisFilePrefix = pptBaseName(paste0("_extra_", thisLitterNum)),
  plot = PreputialSep_freqPlot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
```

```{r}
VO_freqPlot
Estrus_freqPlot
PreputialSep_freqPlot

ppt <- addSlide_threeGraph(
  ppt,
  "Cumuluative frequency plots - first litters",
  VO_freqPlot,
  Estrus_freqPlot,
  PreputialSep_freqPlot
)
```


### Second Litter

```{r}
thisLitterNum <- 2

VO_freqPlot2 <- df_females %>%
  filter(
    litterNum == thisLitterNum
  )%>%
  temp_cumFreq_plot(
    VO_age,
    "vaginal opening",
    zoom_x = TRUE,
    xmin = 25,
    xmax = max_age,
    textSize = 16
  ) #+ 
  # facetForLitterNum

Estrus_freqPlot2 <- df_females %>%
  filter(
    litterNum == thisLitterNum
  ) %>%
  temp_cumFreq_plot(
    Estrus_age,
    "first estrus",
    zoom_x = TRUE,
    xmin = 25,
    xmax = max_age,
    textSize = 16
  ) #+ 
  # facetForLitterNum

PreputialSep_freqPlot2 <- df_males %>%
  filter(
    litterNum == thisLitterNum
  ) %>%
  temp_cumFreq_plot(
    PreputialSep_age,
    "preputial separation",
    zoom_x = TRUE,
    xmin = 25,
    xmax = max_age,
    textSize = 16
  ) #+ 
  # facetForLitterNum

flexSave(
  baseName = "VO_freq_plot",
  thisFilePrefix = pptBaseName(paste0("_extra_", thisLitterNum)),
  plot = VO_freqPlot2,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
flexSave(
  baseName = "Estrus_freq_plot",
  thisFilePrefix = pptBaseName(paste0("_extra_", thisLitterNum)),
  plot = Estrus_freqPlot2,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
flexSave(
  baseName = "PPS_freq_plot",
  thisFilePrefix = pptBaseName(paste0("_extra_", thisLitterNum)),
  plot = PreputialSep_freqPlot2,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, subFolder),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
```

```{r}
VO_freqPlot2
Estrus_freqPlot2
PreputialSep_freqPlot2

ppt <- addSlide_threeGraph(
  ppt,
  "Cumuluative frequency plots - second litters",
  VO_freqPlot2,
  Estrus_freqPlot2,
  PreputialSep_freqPlot2
)
```


# Cycles

```{r}
cycles_filtered <- Cycles_off %>%
  dataFilter()
```


## First litters
```{r}
cycles_1stLitter <- cycles_filtered %>%
  filter(
    litterNum == 1,
    cohort == 2 | cohort == 7 | cohort == 9
  )

cyclesLong_1stLitter <- makeCyclesLong(cycles_1stLitter)
cyclesPerc_long_1stLitter <- makeCyclesPercLong(cycles_1stLitter)
```

### Representative
```{r}
STDMice <- cycles_1stLitter %>%
  filter(
    earlyLifeTrt == "STD"
  )
STDtoUse <- STDMice[sample(nrow(STDMice))[1:6], ] %>% makeCyclesLong()

LBNMice <- cycles_1stLitter %>%
  filter(
    earlyLifeTrt == "LBN"
  )
LBNtoUse <- LBNMice[sample(nrow(LBNMice))[1:6], ] %>% makeCyclesLong()

cycles_1stLitter_STD_plot <- plotCycleTraces(
  STDtoUse, 
  colorValues = c("grey30", "cyan4"),
  fontSize = 16,
  removeFacets = TRUE,
  ncol = 2,
  nrow = 3
  ) + theme(
    # axis.text.x = element_text(size = 16)
    panel.border = element_rect(color = "lightgrey", fill = NA)
  )
cycles_1stLitter_LBN_plot <- plotCycleTraces(
  LBNtoUse,
  colorValues = c("grey30", "cyan4"),
  fontSize = 16,
  removeFacets = TRUE,
  ncol = 2,
  nrow = 3
  )+ theme(
    # axis.text.x = element_text(size = 16)
    panel.border = element_rect(color = "lightgrey", fill = NA)
  )

STD_BaseName = "cycles_1stLitter_STD"
LBN_BaseName = "cycles_1stLitter_LBN"

thisWidth = 4
thisHeight = 5.5

flexSave(
  baseName = STD_BaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = cycles_1stLitter_STD_plot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, "NGP"),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
flexSave(
  baseName = LBN_BaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = cycles_1stLitter_LBN_plot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, "NGP"),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
```

```{r}
cycles_1stLitter_STD_plot
cycles_1stLitter_LBN_plot

ppt <- addSlide_twoGraph(
  ppt,
  "Example cycles for first litter offspring",
  cycles_1stLitter_STD_plot,
  cycles_1stLitter_LBN_plot
)
```


### Percent days in stage
```{r}
plot <- plotCyclesPercent(cyclesPerc_long_1stLitter, fontSize = 16, dotSize = 2.5)

fileBaseName <- "cycles_1stLitter_percDaysStage"

thisWidth = 4.65
thisHeight = 4.62

flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = plot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, "NGP"),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
```

```{r}
plot
ppt <- addSlide_oneGraph(
  ppt,
  "LBN does not affect days spent in each cycle stage for first litter offspring",
  plot
)
```


```{r}
# 5 -> 6
figureNum <- figureNum + 1
# figureNum <- 6
```

## Second litters
```{r}
cycles_2ndLitter <- cycles_filtered %>%
  filter(
    litterNum == 2,
    cohort == 4 | cohort == 6
  )

cyclesLong_2ndLitter <- makeCyclesLong(cycles_2ndLitter)
cyclesPerc_long_2ndLitter <- makeCyclesPercLong(cycles_2ndLitter)
```

### Representative
```{r}
STDMice <- cycles_2ndLitter %>%
  filter(
    earlyLifeTrt == "STD"
  )
STDtoUse <- STDMice[sample(nrow(STDMice))[1:6], ] %>% makeCyclesLong()

LBNMice <- cycles_2ndLitter %>%
  filter(
    earlyLifeTrt == "LBN"
  )
LBNtoUse <- LBNMice[sample(nrow(LBNMice))[1:6], ] %>% makeCyclesLong()

cycles_2ndLitter_STD_plot <- plotCycleTraces(
  STDtoUse, 
  colorValues = c("grey30", "cyan4"),
  fontSize = 16,
  removeFacets = TRUE,
  ncol = 2,
  nrow = 3
  ) + theme(
    # axis.text.x = element_text(size = 16)
    panel.border = element_rect(color = "lightgrey", fill = NA)
  )
cycles_2ndLitter_LBN_plot <- plotCycleTraces(
  LBNtoUse,
  colorValues = c("grey30", "cyan4"),
  fontSize = 16,
  removeFacets = TRUE,
  ncol = 2,
  nrow = 3
  )+ theme(
    # axis.text.x = element_text(size = 16)
    panel.border = element_rect(color = "lightgrey", fill = NA)
  )

STD_BaseName = "cycles_2ndLitter_STD"
LBN_BaseName = "cycles_2ndLitter_LBN"

thisWidth = 4
thisHeight = 5.5

flexSave(
  baseName = STD_BaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = cycles_2ndLitter_STD_plot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, "NGP"),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
flexSave(
  baseName = LBN_BaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = cycles_2ndLitter_LBN_plot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, "NGP"),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
```

```{r}
cycles_2ndLitter_STD_plot
cycles_2ndLitter_LBN_plot

ppt <- addSlide_twoGraph(
  ppt,
  "Example cycles for second litter offspring",
  cycles_2ndLitter_STD_plot,
  cycles_2ndLitter_LBN_plot
)
```

### Percent days in stage
```{r}
plot <- plotCyclesPercent(cyclesPerc_long_2ndLitter, fontSize = 16, dotSize = 2.5)

fileBaseName <- "cycles_2ndLitter_percDaysStage"

thisWidth = 4.65
thisHeight = 4.62

flexSave(
  baseName = fileBaseName,
  thisFilePrefix = pptBaseName(figureNum),
  plot = plot,
  fileType = imgType,
  filePath = file.path(plotOutputFolder, "NGP"),
  width = thisWidth,
  height = thisHeight,
  units = thisUnits,
  compType = currentCompType,
  shinySettings = FALSE
)
```

```{r}
plot
ppt <- addSlide_oneGraph(
  ppt,
  "LBN does not affect days spent in each cycle stage for second litter offspring",
  plot
)
```



```{r}
# 6 -> 7
figureNum <- figureNum + 1
# figureNum <- 7
```

```{r}
# 7 -> 8
figureNum <- figureNum + 1
# figureNum <- 8
```

```{r}
# 9 -> 10
figureNum <- figureNum + 1
# figureNum <- 10
```


