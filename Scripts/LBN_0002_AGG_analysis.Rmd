---
title: "Limited Bedding and Nesting Project Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r Load-Packages}

library(tidyverse)
library(readr)
library(rlang)
library(purrr)
library(scales)
library(knitr)
#library(flextable) #error with data.table
library(officer)
library(GGally)
library(dplyr)
library(ggfortify)
library(openxlsx)
library(lubridate)


```

```{r setUp}

source("./Scripts/LBN_0002_AGG_setUp.R")
dateToday = Sys.Date()

```

```{r LoadData}
DFs <- load_LBN_data(
  dataFolder = DataFolder,
  excelName = LBN_DataName
)

Demo_dam <- DFs$Demo_dam
Demo_off <- DFs$Demo_off
Mass_off <- DFs$Mass_off
Maturation_off <- DFs$Maturation_off
EndPara_off <- DFs$EndPara_off
Cycles_off <- DFs$Cycles_off
AcuteStress_off <- DFs$AcuteStress_off
ChronicStress_off <- DFs$ChronicStress_off
LBN_all <- DFs$LBN_all
LBN_data <- DFs$LBN_data


Demo_dam
Demo_off
Mass_off
Maturation_off
EndPara_off
Cycles_off
AcuteStress_off
ChronicStress_off
LBN_all
LBN_data


```

```{r}
#Dam and Litter Dates

Dam_dates <- damDatesFunc(Demo_dam)
Dam_dates


Off_dates <- offDatesFunc(LBN_data)
Off_dates
```



```{r DataFrame-Workbook}
LBN_df_wb <- createWorkbook()

writeToWorkbook("Demo_dam", Demo_dam, LBN_df_wb)
writeToWorkbook("Demo_off", Demo_off, LBN_df_wb)
writeToWorkbook("Mass_off", Mass_off, LBN_df_wb)
writeToWorkbook("Maturation_off", Maturation_off, LBN_df_wb)
writeToWorkbook("EndPara_off", EndPara_off, LBN_df_wb)
writeToWorkbook("Cycles_off", Cycles_off, LBN_df_wb)
writeToWorkbook("AcuteStress_off", AcuteStress_off, LBN_df_wb)
writeToWorkbook("ChronicStress_off", ChronicStress_off, LBN_df_wb)
writeToWorkbook("LBN_all", LBN_all, LBN_df_wb)
writeToWorkbook("LBN_data", LBN_data, LBN_df_wb)

#Saved in "Save-Workbooks" sections
```


```{r Save-Workbooks}
saveWorkbook(LBN_df_wb, file.path(DataOutFolder, paste0("LBN_data_", dateToday, ".xlsx")), overwrite = TRUE)


```

```{r Save-Powerpoints}
#save the powerpoints
#print(KNDy_PPT, target = file.path(DataOutputFolder, "KNDy Graphs.pptx"))


```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
